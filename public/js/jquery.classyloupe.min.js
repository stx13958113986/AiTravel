/*!
 * jQuery ClassyLoupe
 * vox.SPACE
 *
 * Written by Marius Stanciu - Sergiu <marius@vox.space>
 * Licensed under the MIT license https://vox.SPACE/LICENSE-MIT
 * Version 1.2.1
 *
 */(function(b){var n=0;b.fn.ClassyLoupe=function(a){n++;if(1<this.length)return this.each(function(){b(this).ClassyLoupe(a)}),this;a=b.extend({trigger:"mouseenter",shape:"circle",roundedCorners:10,loupeToggleSpeed:"medium",loupeToggleEasing:"linear",size:200,minSize:150,maxSize:250,glossy:!0,shadow:!0,resize:!0,sizeSnap:10,resizeAnimationSpeed:"medium",resizeAnimationEasing:"easeOutBack",canZoom:!0,zoomKey:90,zoom:100,minZoom:50,maxZoom:200,zoomSnap:5,zoomAnimationSpeed:"medium",zoomAnimationEasing:"easeOutBack", overlay:!0,overlayOpacity:0.5,overlayEffectSpeed:"slow",overlayEffectEasing:"easeOutBack",overlayClassName:""},a||{});var l=jQuery(this),c="classyloupe-"+n,w="classyloupe_overlay-"+n,g=a.size,k,x=null,y=0,z=0,B=0,C=0,t=0,u=0,A=!1,v=!1,s=a.zoom,p=0,q=0,e;return this.each(function(){function n(){var d=g-2*b("#"+c+" .lglossy").css("marginTop"),e=g/2,h=0,f=0;"circle"===a.shape?f=h=e:"rounded"===a.shape&&(h=parseInt(b("#"+c).css("border-top-width")),f=h=a.roundedCorners-h);b("#"+c+" .glossy").stop().animate({width:d+ "px",height:e+"px","-webkit-border-top-left-radius":h+"px","-webkit-border-top-right-radius":f+"px","-moz-border-radius-topleft":h+"px","-moz-border-radius-topright":f+"px","border-top-left-radius":h+"px","border-top-right-radius":f+"px"},{queue:!1,easing:a.resizeAnimationEasing,duration:a.resizeAnimationSpeed})}function D(d,e){if(A&&a.canZoom){if(!(s+a.zoomSnap*d>a.maxZoom||s+a.zoomSnap*d<a.minZoom)){s+=a.zoomSnap*d;t+=Math.round(B*a.zoomSnap/100)*d;u+=Math.round(C*a.zoomSnap/100)*d;var h=e.pageY- this.offsetTop;p=-1*Math.round(t/y*(e.pageX-this.offsetLeft))+g/2;q=-1*Math.round(u/z*h)+g/2;b("#"+c).animate({"background-position":p+"px "+q+"px","background-size":t+"px "+u+"px"},{queue:!1,easing:a.zoomAnimationEasing,duration:a.zoomAnimationSpeed,complete:function(){k=b("#"+c).outerWidth();var a=new jQuery.Event("mousemove",{pageX:r+k/2,pageY:m+k/2});l.trigger(a)}})}}else if(a.resize&&!(A||(h=d*a.sizeSnap,g+h>a.maxSize||g+h<a.minSize))){g+=h;var f=0,r=Math.round(b("#"+c).offset().left-h),m=Math.round(b("#"+ c).offset().top-h);p+=h;q+=h;b("#"+c).stop();"circle"===a.shape?(f=g/2,b("#"+c).animate({width:g+"px",height:g+"px","-webkit-border-top-left-radius":f+"px","-webkit-border-top-right-radius":f+"px","-webkit-border-bottom-left-radius":f+"px","-webkit-border-bottom-right-radius":f+"px","-moz-border-radius-topleft":f+"px","-moz-border-radius-topright":f+"px","-moz-border-radius-bottomleft":f+"px","-moz-border-radius-bottomright":f+"px","border-top-left-radius":f+"px","border-top-right-radius":f+"px", "border-bottom-left-radius":f+"px","border-bottom-right-radius":f+"px","background-position":p+"px "+q+"px",left:r+"px",top:m+"px"},{queue:!1,easing:a.resizeAnimationEasing,duration:a.resizeAnimationSpeed,complete:function(){k=b("#"+c).outerWidth();var a=new jQuery.Event("mousemove",{pageX:r+k/2,pageY:m+k/2});l.trigger(a)}})):"rounded"===a.shape?b("#"+c).animate({width:g+"px",height:g+"px","-webkit-border-radius":a.roundedCorners,"-moz-border-radius":a.roundedCorners,"border-radius":a.roundedCorners, "background-position":p+"px "+q+"px",left:r+"px",top:m+"px"},{queue:!1,easing:a.resizeAnimationEasing,duration:a.resizeAnimationSpeed,complete:function(){k=b("#"+c).outerWidth();var a=new jQuery.Event("mousemove",{pageX:r+k/2,pageY:m+k/2});l.trigger(a)}}):"square"===a.shape&&b("#"+c).animate({width:g+"px",height:g+"px","background-position":p+"px "+q+"px",left:r+"px",top:m+"px"},{queue:!1,easing:a.resizeAnimationEasing,duration:a.resizeAnimationSpeed,complete:function(){k=b("#"+c).outerWidth();var a= new jQuery.Event("mousemove",{pageX:r+k/2,pageY:m+k/2});l.trigger(a)}});a.glossy&&n()}}(function(){l.is("a")?(x=l.attr("href"),e=l.find("img")):(l.is("img")||l.is('input[type="image"]'))&&(x=l.attr("src"),e=l);y=e.width();z=e.height();b("body").append('<div class="classyloupe" id="'+c+'"></div>');var d=new Image;d.onload=function(){B=this.width;C=this.height;t=Math.round(B*s/100);u=Math.round(C*s/100);var d=g/2;b("#"+c).css({width:g+"px",height:g+"px","background-image":"url("+x+")","background-size":t+ "px "+u+"px"});"circle"===a.shape?b("#"+c).css({"-webkit-border-radius":d+"px","-moz-border-radius":d+"px","border-radius":d+"px"}):"rounded"===a.shape&&b("#"+c).css({"-webkit-border-radius":a.roundedCorners,"-moz-border-radius":a.roundedCorners,"border-radius":a.roundedCorners+"px"});k=b("#"+c).outerWidth();a.glossy&&b("#"+c).append('<div class="lglossy"></div>');a.overlay&&(b("body").append("<div class='loverlay "+a.overlayClassName+"' id='"+w+"'></div>"),b("#"+w).css({top:e.offset().top+"px",left:e.offset().left+ "px",width:e.outerWidth()+"px",height:e.outerHeight()+"px"}));a.shadow&&b("#"+c).addClass("lshadow")};d.src=x})();(a.resize||a.canZoom)&&b.event.special.mousewheel&&b("#"+c).bind("mousewheel",function(a,b){D(b,a);return!1});e.bind(a.trigger,function(d){v?(b("#"+c).fadeOut(a.loupeToggleSpeed,a.loupeToggleEasing),v=!1,a.overlay&&b("#"+w).fadeOut(a.overlayEffectSpeed,a.overlayEffectEasing)):(b("#"+c).fadeIn(a.loupeToggleSpeed,a.loupeToggleEasing),v=!0,a.overlay&&b("#"+w).fadeTo(a.overlayEffectSpeed, a.overlayOpacity,a.overlayEffectEasing),n());if("click"===d.type)return d.preventDefault?d.preventDefault():d.returnValue=!1,!1});b("#"+c).bind("click",function(){e.trigger("click")});b(document).bind("mousemove",function(d){if(!v)return!0;var l=parseInt(e.css("border-left-width"))+parseInt(e.css("padding-left")),h=parseInt(e.css("border-top-width"))+parseInt(e.css("padding-top")),f=parseInt(e.css("border-right-width"))+parseInt(e.css("padding-right")),r=parseInt(e.css("border-bottom-width"))+parseInt(e.css("padding-bottom")), m=d.pageX-e.offset().left-l,n=d.pageY-e.offset().top-h,s=Math.round(d.pageX-k/2);d=Math.round(d.pageY-k/2);p=-1*Math.round(t/y*m)+g/2;q=-1*Math.round(u/z*n)+g/2;b("#"+c).css({"background-position":p+"px "+q+"px"});b("#"+c).css({left:s+"px",top:d+"px"});if(m<-l||n<-h||m>y+f||n>z+r)b("#"+c).fadeOut(a.loupeToggleSpeed),v=!1,a.overlay&&b("#"+w).fadeOut(a.overlayEffectSpeed)});b(document).keyup(function(b){if(b.which==a.zoomKey&&v)return A=!1,b.preventDefault?b.preventDefault():b.returnValue=!1,!1}).keydown(function(b){if(b.which== a.zoomKey&&v)return A=!0,b.preventDefault?b.preventDefault():b.returnValue=!1,!1})})}})(jQuery);